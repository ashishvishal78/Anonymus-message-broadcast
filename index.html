<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="style.css">
	<title>Anonymous Message Broadcast</title>
	<script type="text/javascript" src="script.js"></script>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
</head>
<body>

	<header>
		<h1 id="title">ANONYMUS MESSAGE BROADCAST</h1>
		<input type="hidden" id="uname" name="usr" value="">
	</header>
	
	<section>
		<div class="col-5-3 col message" id="area">
				<h2>Start your chat here</h2>
				<ul>
					<li><p>Here is the information you have submitted:</p></li>
				</ul>
		</div><!--
		--><div class="col-5-2 col", id="profile">
			<h1 id="show_uname"></h1>
			<p id="is_member">You are not a member of this group</p>

			<details>
				<summary>
					Announced Xor of group members:
				</summary>
				<div id="annxor">

				</div>
			</details>
			<!-- <ul>
				<li><p>Number of people in chat: </p></li>
				<li><p>Your toss id: </p></li>
				<li><p>Your right neighbour Toss: </p></li>
				<li><p> Xor of both toss :</p></li>
				<li><p> Send Xor: </p></li>
			</ul> -->

			<button class="btn" onclick="addmember(document.getElementById('uname').value)">
				<p>join group</p>
			</button>

			<button class="btn" onclick="removemember(document.getElementById('uname').value)">
				<p>Leave group</p>
			</button>
			

		</div>
	</section>


	<footer id="footer">
	   <p class="txr">
		   <textarea name="message" id="message" cols="45" rows="3" spellcheck="false"></textarea>
	   </p>
	   <p class="txr1">
	   	<button class="btn" onclick="sen_msg(document.getElementById('message').value,document.getElementById('uname').value)">
			<p>Send message</p>
		</button>
	   </p>
	</footer>

<!-- changes -->
	<script>
		start_un();
		setInterval(function(){ recur(); }, 1000);


		function recur(){
			var jj = new XMLHttpRequest();

			jj.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				// console.log(jj.responseText);

				var res=jj.responseText;
				var stind=res.indexOf('*');
				var stind1=res.lastIndexOf('*');
				var tl=res.length;
	

				document.getElementById("area").innerHTML = res.substring(0,stind)+res.substring(stind1+1,tl);

				document.getElementById("annxor").innerHTML=res.substring(stind+1,stind1);
				console.log(res.substring(stind+1,stind1));
			
				var element = document.getElementById("area");
				element.scrollTop = element.scrollHeight;
				
				}
			}
			jj.open("GET", "frame.php?"+new Date().getTime(), true);
			jj.send();
		}


	</script>

</body>
</html>